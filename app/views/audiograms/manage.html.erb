<!-- app/views/audiograms/manage.html.erb -->
<div class="container mt-5 mb-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>User Profile</h2>
    <%= button_to 'Logout', logout_path, method: :delete, class: 'btn btn-outline-secondary' %>
  </div>

  <div class="card shadow-sm p-4">
    <h3 class="mb-4 text-center fw-bold">Manage Your Audiogram</h3>

    <!-- Upload Existing Audiogram -->
    <section class="mb-5">
      <h5>Upload Existing Audiogram</h5>
      <div class="border border-2 border-dashed p-4 text-center rounded-3 bg-light"
           style="border-style: dashed;">
        <div class="mb-2">
          <i class="bi bi-folder2-open fs-1"></i>
        </div>
        <p class="mb-1 fw-semibold">Drag & Drop files here or
          <label for="file-upload" class="text-primary text-decoration-underline" style="cursor:pointer;">Browse</label>
        </p>
        <input id="file-upload" type="file" name="audiogram[file]" class="d-none" accept=".pdf,.csv,.jpg,.png">
        <p class="text-muted small">Supported formats: PDF, CSV, JPG, PNG</p>
      </div>
    </section>

    <hr class="my-4 text-muted fw-bold" />
    <p class="text-center text-muted">OR</p>
    <hr class="my-4 text-muted fw-bold" />

    <!-- Create New Audiogram -->
    <section>
      <h5>Create New Audiogram</h5>

      <div class="row mt-4">
        <div class="col-md-8">
          <!-- Placeholder for audiogram chart -->
          <div class="border rounded-3 p-3 bg-white">
            <canvas id="audiogramChart" height="200"></canvas>
          </div>
        </div>

        <div class="col-md-4">
          <div class="d-flex flex-column align-items-center">
            <label class="fw-semibold mb-2">Right Ear (O)</label>
            <div class="btn-group mb-3" role="group" aria-label="ear-controls">
              <button class="btn btn-outline-primary">+</button>
              <button class="btn btn-outline-primary">−</button>
              <button class="btn btn-outline-danger">×</button>
            </div>

            <div class="d-flex flex-column gap-2">
              <button class="btn btn-outline-secondary">Save Draft</button>
              <button class="btn btn-outline-danger">Clear</button>
              <%= button_to 'Submit Audiogram', audiograms_path, method: :post, class: 'btn btn-dark' %>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<!-- Optional: Bootstrap icons + Chart.js -->
<%= javascript_include_tag "https://cdn.jsdelivr.net/npm/chart.js" %>
<%= javascript_include_tag "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.js" %>

<script>
    // Example Audiogram chart (placeholder)
    document.addEventListener("DOMContentLoaded", () => {
        const ctx = document.getElementById('audiogramChart');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: [250, 500, 1000, 2000, 4000, 8000],
                datasets: [{
                    label: 'Right Ear (O)',
                    data: [20, 40, 70, 50, 30, 20],
                    borderWidth: 2,
                    borderColor: '#007bff',
                    fill: false,
                    tension: 0.3,
                    pointBackgroundColor: '#007bff'
                }]
            },
            options: {
                scales: {
                    y: {
                        title: { display: true, text: 'Hearing Level (dB)' },
                        min: 0,
                        max: 120
                    },
                    x: {
                        title: { display: true, text: 'Frequency (Hz)' }
                    }
                }
            }
        });
    });
</script>
